<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Settings - SimpleWatch</title>
    <link rel="stylesheet" href="/static/css/theme.css">
    <link rel="stylesheet" href="/static/css/settings.css">
</head>
<body>
    <div id="navigation" data-page="settings"></div>

    <div class="main-container">
        <h1 class="page-title">Settings</h1>

        <!-- Appearance Settings -->
        <div class="page-section">
            <h2 class="section-title">
                <span class="section-icon" id="zapIcon"></span>
                Appearance
            </h2>
            <div class="setting-row">
                <div class="setting-info">
                    <div class="setting-label">Theme</div>
                    <div class="setting-desc">Switch between light and dark mode</div>
                </div>
                <div id="settingsThemeToggle"></div>
            </div>
        </div>

        <!-- API Key -->
        <div class="page-section">
            <h2 class="section-title">
                <span class="section-icon" id="keyIcon"></span>
                API Key
            </h2>
            <p style="color: var(--text-secondary); margin-bottom: 1rem;">Use this key to authenticate API requests from your scripts and applications.</p>

            <div class="api-key-display" id="apiKeyDisplay">
                <span id="apiKeyValue">••••••••••••••••••••••••••••••••</span>
            </div>

            <div style="display: flex; gap: 1rem; margin-top: 1rem;">
                <button onclick="toggleApiKeyVisibility()" class="btn btn-secondary" id="toggleBtn">
                    <svg width="16" height="16" fill="currentColor" viewBox="0 0 20 20" style="display: inline; margin-right: 0.5rem;">
                        <path d="M10 12a2 2 0 100-4 2 2 0 000 4z"></path>
                        <path fill-rule="evenodd" d="M.458 10C1.732 5.943 5.522 3 10 3s8.268 2.943 9.542 7c-1.274 4.057-5.064 7-9.542 7S1.732 14.057.458 10zM14 10a4 4 0 11-8 0 4 4 0 018 0z" clip-rule="evenodd"></path>
                    </svg>
                    Show Key
                </button>
                <button onclick="copyApiKey()" class="btn btn-secondary">
                    <svg width="16" height="16" fill="currentColor" viewBox="0 0 20 20" style="display: inline; margin-right: 0.5rem;">
                        <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z"></path>
                        <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z"></path>
                    </svg>
                    Copy Key
                </button>
                <button onclick="regenerateApiKey()" class="btn btn-danger">
                    <svg width="16" height="16" fill="currentColor" viewBox="0 0 20 20" style="display: inline; margin-right: 0.5rem;">
                        <path fill-rule="evenodd" d="M4 2a1 1 0 011 1v2.101a7.002 7.002 0 0111.601 2.566 1 1 0 11-1.885.666A5.002 5.002 0 005.999 7H9a1 1 0 010 2H4a1 1 0 01-1-1V3a1 1 0 011-1zm.008 9.057a1 1 0 011.276.61A5.002 5.002 0 0014.001 13H11a1 1 0 110-2h5a1 1 0 011 1v5a1 1 0 11-2 0v-2.101a7.002 7.002 0 01-11.601-2.566 1 1 0 01.61-1.276z" clip-rule="evenodd"></path>
                    </svg>
                    Regenerate
                </button>
            </div>
            <p style="font-size: 0.75rem; color: var(--text-tertiary); margin-top: 0.5rem; display: flex; align-items: center; gap: 0.375rem;">
                <span class="icon" style="width: 14px; height: 14px; color: var(--status-degraded);" id="warningIcon"></span>
                <span>Warning: Regenerating will invalidate your current key</span>
            </p>
        </div>

        <!-- Data Retention -->
        <div class="page-section">
            <h2 class="section-title">
                <span class="section-icon" id="databaseIcon"></span>
                Data Retention
            </h2>
            <p class="section-desc">Control how long status update history is stored in the database. Older data will be automatically cleaned up daily.</p>

            <div class="retention-control">
                <div class="retention-input-group">
                    <input type="number" id="retentionDaysInput" class="retention-input" min="1" placeholder="90">
                    <span class="retention-unit">days</span>
                </div>
                <button onclick="showRetentionModal()" class="btn btn-primary retention-save-btn">
                    Save Retention Policy
                </button>
            </div>

            <div class="retention-info">
                <span class="icon retention-info-icon" id="infoCircleIcon"></span>
                <span>Current retention: <strong id="currentRetentionDays">90</strong> days</span>
            </div>
        </div>

    </div>

    <!-- Data Retention Confirmation Modal -->
    <div id="retentionModal" class="modal-backdrop hidden">
        <div class="modal-content retention-modal">
            <div class="modal-header">
                <h2 class="modal-title">Confirm Data Retention Change</h2>
                <button onclick="closeRetentionModal()" class="modal-close">
                    <span class="icon" id="modalCloseIcon"></span>
                </button>
            </div>

            <div class="modal-body">
                <div class="alert-box alert-warning">
                    <span class="alert-icon" id="warningTriangleIcon"></span>
                    <div class="alert-content">
                        <p class="alert-title">This action will immediately clean up old data</p>
                        <p class="alert-text">Setting retention to <strong id="modalRetentionDays">0</strong> days will remove all status updates older than this period. This action cannot be undone.</p>
                    </div>
                </div>

                <div class="retention-confirm-details">
                    <div class="retention-detail-row">
                        <span class="retention-detail-label">Current retention:</span>
                        <span class="retention-detail-value"><strong id="modalCurrentRetention">90</strong> days</span>
                    </div>
                    <div class="retention-detail-row">
                        <span class="retention-detail-label">New retention:</span>
                        <span class="retention-detail-value retention-detail-highlight"><strong id="modalNewRetention">0</strong> days</span>
                    </div>
                </div>
            </div>

            <div class="modal-footer">
                <button onclick="closeRetentionModal()" class="btn btn-secondary">Cancel</button>
                <button onclick="confirmRetentionChange()" class="btn btn-danger">Confirm &amp; Apply</button>
            </div>
        </div>
    </div>

    <script src="/static/js/components.js"></script>
    <script src="/static/js/theme.js"></script>
    <script src="/static/js/api.js"></script>
    <script src="/static/js/auth.js"></script>
    <script src="/static/js/nav.js"></script>
    <script src="/static/js/settings.js"></script>
</body>
</html>
